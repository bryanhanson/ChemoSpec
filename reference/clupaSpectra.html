<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hierarchical Cluster-Based Peak Alignment on a Spectra Object — clupaSpectra • ChemoSpec</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Hierarchical Cluster-Based Peak Alignment on a Spectra Object — clupaSpectra"><meta property="og:description" content="This function is a wrapper to several functions in the speaq package.
It implements the CluPA algorithm described in the reference."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">6.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ChemoSpec.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bryanhanson/ChemoSpec/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Hierarchical Cluster-Based Peak Alignment on a Spectra Object</h1>
    <small class="dont-index">Source: <a href="https://github.com/bryanhanson/ChemoSpec/blob/HEAD/R/clupaSpectra.R" class="external-link"><code>R/clupaSpectra.R</code></a></small>
    <div class="hidden name"><code>clupaSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a wrapper to several functions in the <span class="pkg">speaq</span> package.
It implements the CluPA algorithm described in the reference.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">clupaSpectra</span><span class="op">(</span><span class="va">spectra</span>, bT <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>spectra</dt>
<dd><p>An object of S3 class <code><a href="Spectra.html">Spectra</a></code>.</p></dd>
<dt>bT</dt>
<dd><p>Numeric.  The baseline threshold. Defaults to five percent of the
range of the data, in <code>spectra$data</code>.  Passed to
<code>detectSpecPeaks</code>.</p></dd>
<dt>...</dt>
<dd><p>Other arguments to be passed to the underlying functions.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A modifed <code><a href="Spectra.html">Spectra</a></code> object.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Vu TN, Valkenborg D, Smets K, Verwaest KA, Dommisse R, Lemiere F, Verschoren
A, Goethals B, Laukens K. "An integrated workflow for robust alignment and
simplified quantitative analysis of NMR spectrometry data" BMC
Bioinformatics vol. 12 pg. 405 (2011).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Additional documentation at <a href="https://bryanhanson.github.io/ChemoSpec/" class="external-link">https://bryanhanson.github.io/ChemoSpec/</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bryan A. Hanson (DePauw University)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">alignMUD</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">alignMUD</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, lab.pos <span class="op">=</span> <span class="fl">4.5</span>, offset <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span class="r-in">  yrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span><span class="op">)</span>, amp <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Misaligned NMR Spectra"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">1.8</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1900</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="r-in"><span class="va">p1</span></span>
<span class="r-plt img"><img src="clupaSpectra-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">aMUD</span> <span class="op">&lt;-</span> <span class="fu">clupaSpectra</span><span class="op">(</span><span class="va">alignMUD</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 1 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 2 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 3 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 4 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 5 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 6 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 7 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 8 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 9 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 10 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 11 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 12 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 13 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 14 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 15 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 16 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 17 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 18 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 19 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Spectrum 20 has 4 peaks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  --------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CluPA will run with maxShift= 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  If you want CluPA automatically detect the optimal maxShift,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  let try with dohCluster(...,maxShift=NULL,..)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  --------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aligning spectrum  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median pearson correlation of aligned spectra: 0.9999948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Alignment time:  0.001016667  minutes</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">aMUD</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, lab.pos <span class="op">=</span> <span class="fl">4.5</span>, offset <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span class="r-in">  yrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span><span class="op">)</span>, amp <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Aligned NMR Spectra"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">1.8</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1900</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="r-in"><span class="va">p2</span></span>
<span class="r-plt img"><img src="clupaSpectra-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>


<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Normalize a Spectra Object — normSpectra • ChemoSpec</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Normalize a Spectra Object — normSpectra" />
<meta property="og:description" content="This function carries out normalization of the spectra in a
Spectra object.  There are currently four options:
&quot;PQN&quot; carries out &quot;Probabalistic Quotient Normalization&quot; as described
    in the reference.  This is probably the best option for many data sets.
&quot;TotInt&quot; normalizes by total intensity.  In this
    case, the y-data of a Spectra object is normalized by dividing
    each y-value by the sum of the y-values in a given spectrum.  Thus each
    spectrum sums to 1.  This method assumes that the total concentration of
    all substances giving peaks does not vary across samples which may not be true.
&quot;Range&quot; allows one to do something similar to &quot;TotInt&quot; but rather than using the
    sum of the entire spectrum as the denominator, only the sum of the given
    range is used.  This would be appropriate if there was an internal standard
    in the spectrum which was free of interferance, and one wanted to normalize
    relative to it.
&quot;zero2one&quot; scales each spectrum separately to a [0 ... 1] scale.
    This is sometimes useful for visual comparison of chromatograms but is
    inappropriate for spectral data sets.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">5.3.21</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ChemoSpec.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bryanhanson/ChemoSpec/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Normalize a Spectra Object</h1>
    <small class="dont-index">Source: <a href='https://github.com/bryanhanson/ChemoSpec/blob/master/R/normSpectra.R'><code>R/normSpectra.R</code></a></small>
    <div class="hidden name"><code>normSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function carries out normalization of the spectra in a
<code><a href='Spectra.html'>Spectra</a></code> object.  There are currently four options:</p><ul>
<li><p><code>"PQN"</code> carries out "Probabalistic Quotient Normalization" as described
    in the reference.  This is probably the best option for many data sets.</p></li>
<li><p><code>"TotInt"</code> normalizes by total intensity.  In this
    case, the y-data of a <code><a href='Spectra.html'>Spectra</a></code> object is normalized by dividing
    each y-value by the sum of the y-values in a given spectrum.  Thus each
    spectrum sums to 1.  This method assumes that the total concentration of
    all substances giving peaks does not vary across samples which may not be true.</p></li>
<li><p><code>"Range"</code> allows one to do something similar to <code>"TotInt"</code> but rather than using the
    sum of the entire spectrum as the denominator, only the sum of the given
    range is used.  This would be appropriate if there was an internal standard
    in the spectrum which was free of interferance, and one wanted to normalize
    relative to it.</p></li>
<li><p><code>"zero2one"</code> scales each spectrum separately to a [0 ... 1] scale.
    This is sometimes useful for visual comparison of chromatograms but is
    inappropriate for spectral data sets.</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>normSpectra</span><span class='op'>(</span><span class='va'>spectra</span>, method <span class='op'>=</span> <span class='st'>"PQN"</span>, RangeExpress <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>spectra</th>
      <td><p>An object of S3 class <code><a href='Spectra.html'>Spectra</a></code> to be normalized.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>One of <code><a href='https://rdrr.io/r/base/c.html'>c("PQN", "TotInt", "Range", "zero2one")</a></code> giving
the method for normalization.</p></td>
    </tr>
    <tr>
      <th>RangeExpress</th>
      <td><p>A vector of
logicals (must be of <code><a href='https://rdrr.io/r/base/length.html'>length(Spectra$freq)</a></code>).  This vector should be <code>TRUE</code> for
the frequency range you want to serve as the basis for norming, and <code>FALSE</code> otherwise.
The entire spectrum will be divided by the sum of the <code>TRUE</code> range.  See the examples.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of S3 class <code><a href='Spectra.html'>Spectra</a></code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Probabalistic Quotient Normalization is reported in F. Dieterle
et. al. Analytical Chemistry vol. 78 pages 4281-4290 (2006).  The exact same
mathematics are called "median fold change normalization" by Nicholson's
group, reported in K. A. Veselkov et. al. Analytical Chemistry vol. 83 pages
5864-5872 (2011).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Additional documentation at <a href='https://bryanhanson.github.io/ChemoSpec/'>https://bryanhanson.github.io/ChemoSpec/</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Bryan A. Hanson, DePauw University.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>SrE.IR</span><span class='op'>)</span>

<span class='co'># Default PQN normalization</span>
<span class='va'>res1</span> <span class='op'>&lt;-</span> <span class='fu'>normSpectra</span><span class='op'>(</span><span class='va'>SrE.IR</span><span class='op'>)</span>
<span class='fu'><a href='plotSpectra.html'>plotSpectra</a></span><span class='op'>(</span><span class='va'>res1</span><span class='op'>)</span> <span class='co'># compare to plotSpectra(SrE.IR)</span>
</div><div class='img'><img src='normSpectra-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Norm over carbonyl region</span>
<span class='va'>RE</span> <span class='op'>&lt;-</span> <span class='va'>SrE.IR</span><span class='op'>$</span><span class='va'>freq</span> <span class='op'>&gt;</span> <span class='fl'>1650</span> <span class='op'>&amp;</span> <span class='va'>SrE.IR</span><span class='op'>$</span><span class='va'>freq</span> <span class='op'>&lt;</span> <span class='fl'>1800</span>
<span class='va'>res2</span> <span class='op'>&lt;-</span> <span class='fu'>normSpectra</span><span class='op'>(</span><span class='va'>SrE.IR</span>, method <span class='op'>=</span> <span class='st'>"Range"</span>, RangeExpress <span class='op'>=</span> <span class='va'>RE</span><span class='op'>)</span>
<span class='fu'><a href='plotSpectra.html'>plotSpectra</a></span><span class='op'>(</span><span class='va'>res2</span><span class='op'>)</span> <span class='co'># compare to plotSpectra(SrE.IR)</span>
</div><div class='img'><img src='normSpectra-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Check numerically</span>
<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='va'>res2</span><span class='op'>$</span><span class='va'>data</span><span class='op'>[</span>, <span class='va'>RE</span><span class='op'>]</span><span class='op'>)</span> <span class='co'># compare to rowSums(SrE.IR$data[,RE])</span>
</div><div class='output co'>#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



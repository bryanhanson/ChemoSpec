<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Normalize a Spectra Object — normSpectra • ChemoSpec</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Normalize a Spectra Object — normSpectra"><meta property="og:description" content='This function carries out normalization of the spectra in a
Spectra object.  There are currently four options:
"PQN" carries out "Probabalistic Quotient Normalization" as described
in the reference.  This is probably the best option for many data sets.  However, please
be careful if your sample has protein in it, PQN is potentially biased.
See the references.
"TotInt" normalizes by total intensity.  In this
case, the y-data of a Spectra object is normalized by dividing
each y-value by the sum of the y-values in a given spectrum.  Thus each
spectrum sums to 1.  This method assumes that the total concentration of
all substances giving peaks does not vary across samples which may not be true.
"Range" allows one to do something similar to "TotInt" but rather than using the
sum of the entire spectrum as the denominator, only the sum of the given
range is used.  This would be appropriate if there was an internal standard
in the spectrum which was free of interferance, and one wanted to normalize
relative to it.
"zero2one" scales each spectrum separately to a [0...1] scale.
This is sometimes useful for visual comparison of chromatograms but is
inappropriate for spectral data sets.

'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">6.1.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ChemoSpec.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bryanhanson/ChemoSpec/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Normalize a Spectra Object</h1>
    <small class="dont-index">Source: <a href="https://github.com/bryanhanson/ChemoSpec/blob/main/R/normSpectra.R" class="external-link"><code>R/normSpectra.R</code></a></small>
    <div class="hidden name"><code>normSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function carries out normalization of the spectra in a
<code><a href="Spectra.html">Spectra</a></code> object.  There are currently four options:</p><ul><li><p><code>"PQN"</code> carries out "Probabalistic Quotient Normalization" as described
in the reference.  This is probably the best option for many data sets.  However, please
be careful if your sample has protein in it, PQN is potentially biased.
See the references.</p></li>
<li><p><code>"TotInt"</code> normalizes by total intensity.  In this
case, the y-data of a <code><a href="Spectra.html">Spectra</a></code> object is normalized by dividing
each y-value by the sum of the y-values in a given spectrum.  Thus each
spectrum sums to 1.  This method assumes that the total concentration of
all substances giving peaks does not vary across samples which may not be true.</p></li>
<li><p><code>"Range"</code> allows one to do something similar to <code>"TotInt"</code> but rather than using the
sum of the entire spectrum as the denominator, only the sum of the given
range is used.  This would be appropriate if there was an internal standard
in the spectrum which was free of interferance, and one wanted to normalize
relative to it.</p></li>
<li><p><code>"zero2one"</code> scales each spectrum separately to a <code>[0...1]</code> scale.
This is sometimes useful for visual comparison of chromatograms but is
inappropriate for spectral data sets.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">normSpectra</span><span class="op">(</span><span class="va">spectra</span>, method <span class="op">=</span> <span class="st">"PQN"</span>, RangeExpress <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-spectra">spectra<a class="anchor" aria-label="anchor" href="#arg-spectra"></a></dt>
<dd><p>An object of S3 class <code><a href="Spectra.html">Spectra()</a></code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>One of <code>c("PQN", "TotInt", "Range", "zero2one")</code> giving
the method for normalization.</p></dd>


<dt id="arg-rangeexpress">RangeExpress<a class="anchor" aria-label="anchor" href="#arg-rangeexpress"></a></dt>
<dd><p>A vector of
logicals (must be of <code>length(Spectra$freq)</code>).  This vector should be <code>TRUE</code> for
the frequency range you want to serve as the basis for norming, and <code>FALSE</code> otherwise.
The entire spectrum will be divided by the sum of the <code>TRUE</code> range.  See the examples.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of S3 class <code><a href="Spectra.html">Spectra()</a></code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>

<ul><li><p>Probabalistic Quotient Normalization is reported in F. Dieterle
et al. Analytical Chemistry vol. 78 pages 4281-4290 (2006).</p></li>
<li><p>The exact same mathematics are called "median fold change normalization"
by Nicholson's group, reported in K. A. Veselkov et. al. Analytical
Chemistry vol. 83 pages 5864-5872 (2011).</p></li>
<li><p>Corriea et al. "1H NMR Signals from Urine Excreted Protein are
a Source of Bias in Probablistic Quotient Normalization" Analytical Chemistry
vol. 94 pages 6919-6923 (2022).</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Additional documentation at <a href="https://bryanhanson.github.io/ChemoSpec/" class="external-link">https://bryanhanson.github.io/ChemoSpec/</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bryan A. Hanson (DePauw University).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SrE.IR</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reference spectrum before normalization</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">SrE.IR</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Original Spectrum"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span></span></span>
<span class="r-plt img"><img src="normSpectra-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default PQN normalization</span></span></span>
<span class="r-in"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">normSpectra</span><span class="op">(</span><span class="va">SrE.IR</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"PQN Normalization"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2</span></span></span>
<span class="r-plt img"><img src="normSpectra-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Norm over carbonyl region</span></span></span>
<span class="r-in"><span><span class="va">RE</span> <span class="op">&lt;-</span> <span class="va">SrE.IR</span><span class="op">$</span><span class="va">freq</span> <span class="op">&gt;</span> <span class="fl">1650</span> <span class="op">&amp;</span> <span class="va">SrE.IR</span><span class="op">$</span><span class="va">freq</span> <span class="op">&lt;</span> <span class="fl">1800</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">normSpectra</span><span class="op">(</span><span class="va">SrE.IR</span>, method <span class="op">=</span> <span class="st">"Range"</span>, RangeExpress <span class="op">=</span> <span class="va">RE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">res2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Normalized to Carbonyl Peaks"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3</span></span></span>
<span class="r-plt img"><img src="normSpectra-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check numerically</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>, <span class="va">RE</span><span class="op">]</span><span class="op">)</span> <span class="co"># compare to rowSums(SrE.IR$data[,RE])</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>


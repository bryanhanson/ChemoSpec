<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Seriated Heat Map for a Spectra Object — hmapSpectra • ChemoSpec</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Seriated Heat Map for a Spectra Object — hmapSpectra"><meta property="og:description" content="Creates a heat map with marginal dendrograms using seriation procedures.
Heirchical cluster analysis is followed by re-ordering the clusters in a coordinated way
across each dimension (controlled by argument method, see hmap).
The vignette for package seriation has more details."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">6.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ChemoSpec.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bryanhanson/ChemoSpec/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Seriated Heat Map for a Spectra Object</h1>
    <small class="dont-index">Source: <a href="https://github.com/bryanhanson/ChemoSpec/blob/HEAD/R/hmapSpectra.R" class="external-link"><code>R/hmapSpectra.R</code></a></small>
    <div class="hidden name"><code>hmapSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a heat map with marginal dendrograms using seriation procedures.
Heirchical cluster analysis is followed by re-ordering the clusters in a coordinated way
across each dimension (controlled by argument <code>method</code>, see <code><a href="https://rdrr.io/pkg/seriation/man/hmap.html" class="external-link">hmap</a></code>).
The vignette for package <span class="pkg">seriation</span> has more details.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hmapSpectra</span><span class="op">(</span><span class="va">spectra</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>spectra</dt>
<dd><p>An object of S3 class <code><a href="Spectra.html">Spectra</a></code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed downstream.  A great deal of
control is available - check <code><a href="https://rdrr.io/pkg/seriation/man/hmap.html" class="external-link">hmap</a></code> for details.  Most of the control
actually derives from the <code>heatmap</code> function in package <span class="pkg">stats</span>.
See the examples.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list as described in <code><a href="https://rdrr.io/pkg/seriation/man/hmap.html" class="external-link">hmap</a></code>. Side effect is a plot.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    

<p>The underlying <code><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">stats::heatmap</a></code> function does certain things automatically for the user.
For instance, if you pass a vector of names to argument <code>row_labels</code> it is automatically
reordered using the <code>rowInd</code> vector that is computed.  The user does not need to
do the reordering.  Another example is the labeling of the columns.  The labels are
automatically turned 90 degrees, and not every column is labeled to keep things readible.</p>
    </div>
    <div id="interpretation">
    <h2>Interpretation</h2>
    

<p>Looking at the 2nd <code>hmapSpectra</code> example, and keeping in mind the nature of the sample
(see <code><a href="SrE.IR.html">SrE.IR</a></code>), the most similar samples based on the ester peaks (~1740),  are in
the lower right corner of the heatmap.  These are the two outlier samples, composed of triglycerides
which contain the ester functional group (and no detectable carboxylic acid).  The most similar
samples based on the carboxylic acid peaks (~1710) are in the upper left corner.  These samples are
mostly from the "pure" extract group, according to the manufacturer's label.  These samples have a modest
to low amount of the ester functional group, which indicates dilution (or adulteration if you like).
In fact, the first two samples (NP_adSrE and NR_pSrE) are the two samples with the smallest ester
peaks (see first plot in the examples).  This suggests that NP_adSrE was diluted only a little with added
olive oil.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/seriation/man/hmap.html" class="external-link">hmap</a></code> which will get you to the package
(there is no package index page); the vignette is a good place to begin
(<code>browseVignettes("seriation")</code>).  Additional documentation at
<a href="https://bryanhanson.github.io/ChemoSpec/" class="external-link">https://bryanhanson.github.io/ChemoSpec/</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bryan A. Hanson (DePauw University)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SrE.IR</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Let's look just at the carbonyl region</span></span></span>
<span class="r-in"><span><span class="va">IR</span> <span class="op">&lt;-</span> <span class="fu"><a href="removeFreq.html">removeFreq</a></span><span class="op">(</span><span class="va">SrE.IR</span>, rem.freq <span class="op">=</span> <span class="va">SrE.IR</span><span class="op">$</span><span class="va">freq</span> <span class="op">&gt;</span> <span class="fl">1775</span> <span class="op">|</span> <span class="va">SrE.IR</span><span class="op">$</span><span class="va">freq</span> <span class="op">&lt;</span> <span class="fl">1660</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">IR</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span>, lab.pos <span class="op">=</span> <span class="fl">1800</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Defaults, except for color scheme:</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">hmapSpectra</span><span class="op">(</span><span class="va">IR</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="hmapSpectra-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Label samples and frequencies by passing arguments to stats:heatmap</span></span></span>
<span class="r-in"><span><span class="co"># Also make a few other nice plot adjustments</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">hmapSpectra</span><span class="op">(</span><span class="va">IR</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  row_labels <span class="op">=</span> <span class="va">IR</span><span class="op">$</span><span class="va">names</span>, col_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">IR</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="hmapSpectra-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

